<!DOCTYPE html>
<html lang="sv">
<head>
  <meta charset="UTF-8" />
  <title>InkÃ¶pslista</title>
  <script src="https://unpkg.com/@supabase/supabase-js"></script>
</head>
<body>
  <h1>ğŸ›’ InkÃ¶pslista</h1>
  
  <input id="itemInput" type="text" placeholder="LÃ¤gg till vara..." />
  <button onclick="addItem()">LÃ¤gg till</button>
  
  <p id="message"></p>
  <ul id="list"></ul>

  <script>
    const SUPABASE_URL = "DIN_SUPABASE_URL"; 
    const SUPABASE_KEY = "DIN_ANON_KEY"; 
    const supabase = supabase.createClient(SUPABASE_URL, SUPABASE_KEY);

    const list = document.getElementById("list");
    const message = document.getElementById("message");

    async function addItem() {
      const input = document.getElementById("itemInput");
      const name = input.value.trim();

      if (!name) {
        message.textContent = "âš ï¸ Du mÃ¥ste skriva nÃ¥got!";
        return;
      }

      message.textContent = "â³ LÃ¤gger till...";
      console.log("FÃ¶rsÃ¶ker lÃ¤gga till:", name);

      try {
        const { data, error } = await supabase
          .from("items")
          .insert([{ name, checked: false }]);

        if (error) {
          console.error("Supabase-fel:", error);
          message.textContent = "âŒ Kunde inte lÃ¤gga till (" + error.message + ")";
        } else {
          console.log("Inlagt:", data);
          message.textContent = "âœ… Tillagd!";
          input.value = "";
          loadItems();
        }
      } catch (err) {
        console.error("Kodfel:", err);
        message.textContent = "ğŸ’¥ Tekniskt fel: " + err.message;
      }
    }

    async function loadItems() {
      list.innerHTML = "";
      const { data, error } = await supabase.from("items").select("*");

      if (error) {
        console.error("Fel vid hÃ¤mtning:", error);
        message.textContent = "âš ï¸ Kunde inte hÃ¤mta listan.";
        return;
      }

      data.forEach(item => {
        const li = document.createElement("li");
        li.textContent = item.name + (item.checked ? " âœ…" : "");
        list.appendChild(li);
      });
    }

    // Ladda listan direkt
    loadItems();
  </script>
</body>
</html>
